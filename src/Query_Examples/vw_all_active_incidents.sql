SELECT incident.number,
    incident.opened_at,
    incident.short_description,
    incident.active,
    incident.activity_due,
    incident.work_end,
    incident.work_start,
    incident.additional_assignee_list,
    incident.comments,
    incident.approval,
    incident.approval_history,
    incident.approval_set,
    incident.assigned_to,
    incident.assignment_group,
    incident.business_duration,
    incident.business_impact,
    incident.business_stc,
    incident.caller_id,
    incident.category,
    incident.caused_by,
    incident.rfc,
    incident.contact_type,
    incident.child_incidents,
    incident.closed_at,
    incident.closed_by,
    incident.comments_and_work_notes,
    incident.company,
    incident.cmdb_ci,
    incident.contract,
    incident.correlation_id,
    incident.correlation_display,
    incident.sys_created_on,
    incident.sys_created_by,
    incident.delivery_plan,
    incident.delivery_task,
    incident.description,
    incident.sys_domain,
    incident.sys_domain_path,
    incident.due_date,
    incident.calendar_duration,
    incident.task_effective_number,
    incident.escalation,
    incident.expected_start,
    incident.follow_up,
    incident.group_list,
    incident.impact,
    incident.incident_state,
    incident.knowledge,
    incident.reopened_time,
    incident.reopened_by,
    incident.location,
    incident.made_sla,
    incident.notify,
    incident.hold_reason,
    incident.opened_by,
    incident."order",
    incident.origin_id,
    incident.origin_table,
    incident.parent,
    incident.parent_incident,
    incident.priority,
    incident.cause,
    incident.problem_id,
    incident.reassignment_count,
    incident.reopen_count,
    incident.close_code,
    incident.close_notes,
    incident.calendar_stc,
    incident.resolved_at,
    incident.resolved_by,
    incident.sla_due,
    incident.business_service,
    incident.service_offering,
    incident.severity,
    incident.state,
    incident.subcategory,
    incident.sys_tags,
    incident.sys_class_name,
    incident.time_worked,
    incident.route_reason,
    incident.universal_request,
    incident.sys_updated_on,
    incident.sys_updated_by,
    incident.sys_mod_count,
    incident.upon_approval,
    incident.upon_reject,
    incident.urgency,
    incident.user_input,
    incident.watch_list,
    incident.work_notes,
    incident.work_notes_list,
    cmn_location.contact,
    cmn_location.city,
    cmn_location.country,
        CASE
            WHEN incident.business_duration IS NOT NULL THEN incident.business_duration::numeric / 86400::numeric
            ELSE 0::numeric
        END AS resolvetimeindays
   FROM incident
     LEFT JOIN cmn_location ON incident.location::text = cmn_location.name::text
  WHERE incident.active = true